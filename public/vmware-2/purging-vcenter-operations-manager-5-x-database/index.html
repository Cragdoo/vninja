<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Purging the vCenter Operations Manager 5.x Database" />
<meta property="og:description" content="A client of mine recently had their vCenter 5.0 appliance replaced with a new vCenter 5.1 appliance, something vCenter Operations Manager did not enjoy. In this case the original vCenter 5.0 Appliance was turned shut down, a new 5.1 Appliance deployed, with the same IP as the old one, and then configured. Naturally the existing hosts were added to the fresh vCenter, clusters recreated and in general everything was reconfigured." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/vmware-2/purging-vcenter-operations-manager-5-x-database/" />



<meta property="article:published_time" content="2013-02-05T12:26:26&#43;00:00"/>

<meta property="article:modified_time" content="2013-02-05T12:26:26&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Purging the vCenter Operations Manager 5.x Database"/>
<meta name="twitter:description" content="A client of mine recently had their vCenter 5.0 appliance replaced with a new vCenter 5.1 appliance, something vCenter Operations Manager did not enjoy. In this case the original vCenter 5.0 Appliance was turned shut down, a new 5.1 Appliance deployed, with the same IP as the old one, and then configured. Naturally the existing hosts were added to the fresh vCenter, clusters recreated and in general everything was reconfigured."/>
<meta name="generator" content="Hugo 0.40.3" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Purging the vCenter Operations Manager 5.x Database",
  "url": "/vmware-2/purging-vcenter-operations-manager-5-x-database/",
  "wordCount": "514",
  "datePublished": "2013-02-05T12:26:26&#43;00:00",
  "dateModified": "2013-02-05T12:26:26&#43;00:00",
  "author": {
    "@type": "Person",
    "name": "cmohn"
  },
  "keywords": "VMware, vCenter, vCenter Operations Manager, Virtualization"
}
</script>



    <link rel="canonical" href="/vmware-2/purging-vcenter-operations-manager-5-x-database/">

    <title>Purging the vCenter Operations Manager 5.x Database | Adventures in Hugo</title>

    <!-- combined, minified CSS -->
    <link href="/css/style.css" rel="stylesheet" integrity="sha384-NnQTHLV1boeEOT&#43;VkddkaZe9ipwgoxh1CLY2U3LM36/GQpTS/1l4lL/5LnWh02Wk" crossorigin="anonymous">

    

    

    

    

  </head>

  <body>

    
    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="/">Home</a>
          
          <a class="nav-link" href="https://example.org" title="">Link 1</a>
          
        </nav>
      </div>
    </div>
    

    
    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title"><a href="/" rel="home">Adventures in Hugo</a></h1>
        <p class="lead blog-description">There is a thin line between agile and fragile</p>
      </div>
    </header>
    

    
    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="/vmware-2/purging-vcenter-operations-manager-5-x-database/">Purging the vCenter Operations Manager 5.x Database</a></h2>
    <p class="blog-post-meta"><time datetime="2013-02-05T12:26:26Z">Tue Feb 05, 2013</time> by cmohn in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/vmware" rel="category tag">VMware</a>


<i class="fa fa-tag" aria-hidden="true"></i>&nbsp;<a href="/tags/vcenter" rel="tag">vCenter</a>, <a href="/tags/vcenter-operations-manager" rel="tag">vCenter Operations Manager</a>, <a href="/tags/virtualization" rel="tag">Virtualization</a>, <a href="/tags/vmware" rel="tag">VMware</a>

</p>
  </header>
  <p>A client of mine recently had their vCenter 5.0 appliance replaced with a new vCenter 5.1 appliance, something vCenter Operations Manager did not enjoy. In this case the original vCenter 5.0 Appliance was turned shut down, a new 5.1 Appliance deployed, with the same IP as the old one,  and then configured. Naturally the existing hosts were added to the fresh vCenter, clusters recreated and in general everything was reconfigured.</p>

<p>Why a simple <a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=2033990">upgrade from 5.0 to 5.1</a> wasn&rsquo;t performed is beyond me, but the end result was that the existing vCenter Operations Manager I had deployed in this environment was no longer able to monitor the environment.</p>

<p>Simply removing the registration of the old vCenter and replacing it with the new instance was not trivial, as this generated an exception in the vCenter Operations Manager admin interface:</p>

<blockquote>Exception occurred during vCenter Server registration. UUID is not available for the currently registered vCenter ([https://<vcenter](https://%3cvcenter) FQDN>/sdk). This can happen if you added the vCenter from custom UI instead of the admin UI. Please contact support to fix the problem and then attempt to register a new vCenter.</blockquote>

<p>Trying to force the registration from the command line on the vCenter Operations Manager UI VM using the following command also failed, with the same error message:</p>

<p>[cc lang=&ldquo;bash&rdquo; width=&ldquo;95%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;]
vcops-admin register update &ndash;vc-name [vc-name] &ndash;vc-server [<a href="https://vc-server/sdk">https://vc-server/sdk</a>] &ndash;username [vc-username] &ndash;password [vc-password] &ndash;force
[/cc]</p>

<p>Naturally the issue is caused by the non-standard &ldquo;upgrade&rdquo; performed on the vCenter, but the end result that I no longer had old performance data available anywhere. The vCenter database was no longer available, since no actual upgrade was performed and the old vCenter had been removed from vCenter Operations Manager.</p>

<p>My first thought was to simply delete and re-deploy vCenter Operations Manager, but since I was working remotely this wasn&rsquo;t really a viable option, considering that the OVF package was located on my local machine and not in the clients network</p>

<p>After some playing around to try to avoid deploying again over a slow WAN link, I discovered a somewhat undocumented parameter for the _vcops-admin (run on the UI VM command line)_ command.</p>

<p>[cc lang=&ldquo;bash&rdquo; width=&ldquo;95%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;]
vcops-admin purge &ndash;vc-name
[/cc]</p>

<p>This parameter is not listed in the man pages for the _vcops-admin_ command, and what it does is to completely purge a previously registered vCenter. And by purge, it really means purge. <strong>All traces of the old vCenter data is removed from the vCenter Operations Manager database, any old performance data and metrics are completely removed.</strong></p>

<p>In my case this was exactly what I was looking for, since the alternative was to redeploy the whole vCenter Operations Manager package.</p>

<p>**Normally this is not something you want to do, it would be preferable to figure out the root cause of your issues instead of purging your existing database and lose historic data, but in some cases this can come in handy. **</p>

<p>One example would be if you are playing around with vCenter Operations Manager in your lab environment, this is a quick and easy way to start over instead of re-deploying.</p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=%2fvmware-2%2fpurging-vcenter-operations-manager-5-x-database%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=%2fvmware-2%2fpurging-vcenter-operations-manager-5-x-database%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fvmware-2%2fpurging-vcenter-operations-manager-5-x-database%2f" title="Share on LinkedIn"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/home?status=%2fvmware-2%2fpurging-vcenter-operations-manager-5-x-database%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  

  

  
  <section class="sidebar-module">
    <h4>Links</h4>
    <ol class="list-unstyled">
      
      <li><a href="https://example.com">Link 1</a></li>
      
      <li><a href="https://example.org">Link 2</a></li>
      
    </ol>
  </section>
  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->
    

    
    <footer class="blog-footer">
      <p>
      
      &copy; Christian Mohn
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>
    

  </body>

</html>
