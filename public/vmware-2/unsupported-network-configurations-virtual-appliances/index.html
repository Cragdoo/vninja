<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Unsupported Network Configurations in Virtual Appliances" />
<meta property="og:description" content="My recent experience with setting up vCenter Operations Manager on a standalone ESXi host, and the always excellent William Lam´s post Automating VCSA Network Configurations For Greenfield Deployments got me thinking.
There are several other appliances out there that require deployment to a vCenter, to be able to configure the networking options and not just default to DHCP. In many, and perhaps even most, cases you can work around that by running the _vami_set_network _command to change from DHCP to STATIC network configurations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/vmware-2/unsupported-network-configurations-virtual-appliances/" />



<meta property="article:published_time" content="2013-02-19T23:50:20&#43;00:00"/>

<meta property="article:modified_time" content="2013-02-19T23:50:20&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Unsupported Network Configurations in Virtual Appliances"/>
<meta name="twitter:description" content="My recent experience with setting up vCenter Operations Manager on a standalone ESXi host, and the always excellent William Lam´s post Automating VCSA Network Configurations For Greenfield Deployments got me thinking.
There are several other appliances out there that require deployment to a vCenter, to be able to configure the networking options and not just default to DHCP. In many, and perhaps even most, cases you can work around that by running the _vami_set_network _command to change from DHCP to STATIC network configurations."/>
<meta name="generator" content="Hugo 0.40.3" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Unsupported Network Configurations in Virtual Appliances",
  "url": "/vmware-2/unsupported-network-configurations-virtual-appliances/",
  "wordCount": "492",
  "datePublished": "2013-02-19T23:50:20&#43;00:00",
  "dateModified": "2013-02-19T23:50:20&#43;00:00",
  "author": {
    "@type": "Person",
    "name": "cmohn"
  },
  "keywords": "VMware, fun, labs, Linux, SUSE, Unsupported, Virtual Appliance, vSphere"
}
</script>



    <link rel="canonical" href="/vmware-2/unsupported-network-configurations-virtual-appliances/">

    <title>Unsupported Network Configurations in Virtual Appliances | Adventures in Hugo</title>

    <!-- combined, minified CSS -->
    <link href="/css/style.css" rel="stylesheet" integrity="sha384-TbfEhJn4HkgPUIZUhhHaAYsycYKHxSuIloCjZOiyCSpbVunRQxg5T5pxKVFwxilF" crossorigin="anonymous">

    

    

    

    

  </head>

  <body>

    
    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="/">Home</a>
          
          <a class="nav-link" href="https://example.org" title="">Link 1</a>
          
        </nav>
      </div>
    </div>
    

    
    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title"><a href="/" rel="home">Adventures in Hugo</a></h1>
        <p class="lead blog-description">There is a thin line between agile and fragile</p>
      </div>
    </header>
    

    
    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="/vmware-2/unsupported-network-configurations-virtual-appliances/">Unsupported Network Configurations in Virtual Appliances</a></h2>
    <p class="blog-post-meta"><time datetime="2013-02-19T23:50:20Z">Tue Feb 19, 2013</time> by cmohn in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/vmware" rel="category tag">VMware</a>


<i class="fa fa-tag" aria-hidden="true"></i>&nbsp;<a href="/tags/fun" rel="tag">fun</a>, <a href="/tags/labs" rel="tag">labs</a>, <a href="/tags/linux" rel="tag">Linux</a>, <a href="/tags/suse" rel="tag">SUSE</a>, <a href="/tags/unsupported" rel="tag">Unsupported</a>, <a href="/tags/virtual-appliance" rel="tag">Virtual Appliance</a>, <a href="/tags/vmware" rel="tag">VMware</a>, <a href="/tags/vsphere" rel="tag">vSphere</a>

</p>
  </header>
  <p>My recent experience with setting up v<a href="http://vninja.net/vmware-2/vcenter-operations-manager-vcenter-deployment-dependency/">Center Operations Manager on a standalone ESXi host</a>, and the always excellent <a href="http://twitter.com/lamw">William Lam</a>´s post <a href="http://www.virtuallyghetto.com/2013/02/automating-vcsa-network-configurations.html">Automating VCSA Network Configurations For Greenfield Deployments</a> got me thinking.</p>

<p>There are several other appliances out there that require deployment to a vCenter, to be able to configure the networking options and not just default to DHCP. In many, and perhaps even most, cases you can work around that by running the _vami_set_network _command to change from DHCP to STATIC network configurations.</p>

<p>All of that is fine and dandy, and pretty straight forward, but there is one smallish caveat;</p>

<p><strong>You need root access to be able to reconfigure the networking</strong>.</p>

<p>Without it, you will see error messages such as these (Shortened for abbreviation):</p>

<p>[cc lang=&ldquo;bash&rdquo; width=&ldquo;95%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;]@localhost:~/opt/vmware/share/vami/vami_set_network eth0 STATICV4 192.168.5.98 255.255.255.0 192.168.5.1
/sbin/ifdown: line 233: /dev/.sysconfig/network/config-eth0: Permission denied
IOError: [Errno 13] Permission denied: &lsquo;/opt/vmware/etc/vami/vami_ovf_info.xml&rsquo;
Unable to set the network parameters
[/cc]</p>

<p>So, what if you don´t know the appliance root password?</p>

<p>Most virtual appliances are Linux based, and in this particular case the flavor used was SUSE Enterprise Linux 11.</p>

<p>To reset the root password on a grub based Linux appliance, like SUSE, follow the recipe below:</p>

<p><strong>Note:</strong> As <a href="https://twitter.com/lamw/status/304016471829397504">William Lam pointed out</a> this procedure only works if there no grub password set, if that´s the case download a LiveCD, mount the filesystem and run the password change from there. If the filesystem in the appliance is encrypted, well, then all bets are off.</p>

<ol>
<li><p>In the grub menu select the kernel you want to boot and press tab to shift focus to &ldquo;Boot Options&rdquo;</p></li>

<li><p>Now type _**init =/bin/bash **_and press <em>Enter</em> to continue.<a href="http://vninja.net/wordpress/wp-content/uploads/2013/02/SUSE-PW-RESET-01.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2013/02/SUSE-PW-RESET-01-300x202.png" alt="SUSE-PW-RESET-01" /></a></p></li>

<li><p>You will see a prompt that looks like  <strong>(none):/ #</strong> in the terminal.</p></li>

<li><p>Run the _passwd_ command in terminal to change the password for root.
<a href="none">cc lang=&ldquo;bash&rdquo; width=&ldquo;95%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;</a>:/ # passwd
New Password:
Reenter New Password:
Password changed.
[/cc]</p></li>
</ol>

<p>Reboot the appliance, let it boot up normally, and you should now be able to log on as <strong>root</strong>, with your newly configured password, and run the _vami_set_network _command to configure static IP adressing.</p>

<p>[cc lang=&ldquo;bash&rdquo; width=&ldquo;95%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;]
localhost:~ # /opt/vmware/share/vami/vami_set_network eth0 STATICV4 192.168.5.19 255.255.255.0 192.168.5.1
eth0 device: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)
eth0 device: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)
Network parameters successfully changed to requested values
localhost:~ #
[/cc]</p>

<p>Do yet another reboot, and you should be up and running with a static IP configuration on an appliance deployed without the advanced OVF/OVA properties normally required for that kind of deployment.</p>

<p><strong>Note:</strong> <em>This procedure is more than likely NOT supported by your vendor, and changing the root password might have other consequences for the appliance. If the vendor does not supply the root password i their documentation, there is likely to be a reason for that, but the procedure above shows that not supplying it does not actually prevent anyone from changing it. USE AT OWN RISK.</em></p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=%2fvmware-2%2funsupported-network-configurations-virtual-appliances%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=%2fvmware-2%2funsupported-network-configurations-virtual-appliances%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fvmware-2%2funsupported-network-configurations-virtual-appliances%2f" title="Share on LinkedIn"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/home?status=%2fvmware-2%2funsupported-network-configurations-virtual-appliances%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  

  

  
  <section class="sidebar-module">
    <h4>Links</h4>
    <ol class="list-unstyled">
      
      <li><a href="https://example.com">Link 1</a></li>
      
      <li><a href="https://example.org">Link 2</a></li>
      
    </ol>
  </section>
  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->
    

    
    <footer class="blog-footer">
      <p>
      
      &copy; Christian Mohn
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>
    

  </body>

</html>
