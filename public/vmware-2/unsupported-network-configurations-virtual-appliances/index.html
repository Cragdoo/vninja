<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Unsupported Network Configurations in Virtual Appliances  &middot; Adventures in Hugo</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="There is a thin line between agile and fragile" />

<meta name="keywords" content="fun, labs, Linux, SUSE, Unsupported, Virtual Appliance, VMware, vSphere, ">


<meta property="og:title" content="Unsupported Network Configurations in Virtual Appliances  &middot; Adventures in Hugo ">
<meta property="og:site_name" content="Adventures in Hugo"/>
<meta property="og:url" content="/vmware-2/unsupported-network-configurations-virtual-appliances/" />
<meta property="og:locale" content="en-us">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2013-02-19T23:50:20Z" />
<meta property="og:article:modified_time" content="2013-02-19T23:50:20Z" />

  
    
<meta property="og:article:tag" content="fun">
    
<meta property="og:article:tag" content="labs">
    
<meta property="og:article:tag" content="Linux">
    
<meta property="og:article:tag" content="SUSE">
    
<meta property="og:article:tag" content="Unsupported">
    
<meta property="og:article:tag" content="Virtual Appliance">
    
<meta property="og:article:tag" content="VMware">
    
<meta property="og:article:tag" content="vSphere">
    
  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@" />
<meta name="twitter:title" content="Unsupported Network Configurations in Virtual Appliances" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="/vmware-2/unsupported-network-configurations-virtual-appliances/" />
<meta name="twitter:domain" content="/">
  

  
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "Unsupported Network Configurations in Virtual Appliances",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2013-02-19",
    "description": "",
    "wordCount": 492
  }
</script>
  



<link rel="canonical" href="/vmware-2/unsupported-network-configurations-virtual-appliances/" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
<link rel="icon" href="/favicon.png">
<meta name="generator" content="Hugo 0.40.3" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->



    <link rel="stylesheet" href="/css/bootswatch/default/bootstrap.min.css">


<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css">




  <link rel="stylesheet" href="/css/highlight/default.css">


</head>
<body data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
    <header id="main-header">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        
          
          <a class="navbar-brand-img" href="/">
            <img alt="" src="">
            
          </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            
            
            
              
          </ul>
        </div>
        
      </div>
    </nav>
  </header>





<div class="container">
  <div class="row">
    <div class="col-sm-12">


      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" >
<header class="container hat">
  <h1>Unsupported Network Configurations in Virtual Appliances
</h1>

</header>
</div>


      <div class="content">
  <p>My recent experience with setting up v<a href="http://vninja.net/vmware-2/vcenter-operations-manager-vcenter-deployment-dependency/">Center Operations Manager on a standalone ESXi host</a>, and the always excellent <a href="http://twitter.com/lamw">William Lam</a>´s post <a href="http://www.virtuallyghetto.com/2013/02/automating-vcsa-network-configurations.html">Automating VCSA Network Configurations For Greenfield Deployments</a> got me thinking.</p>

<p>There are several other appliances out there that require deployment to a vCenter, to be able to configure the networking options and not just default to DHCP. In many, and perhaps even most, cases you can work around that by running the _vami_set_network _command to change from DHCP to STATIC network configurations.</p>

<p>All of that is fine and dandy, and pretty straight forward, but there is one smallish caveat;</p>

<p><strong>You need root access to be able to reconfigure the networking</strong>.</p>

<p>Without it, you will see error messages such as these (Shortened for abbreviation):</p>

<p>[cc lang=&ldquo;bash&rdquo; width=&ldquo;95%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;]@localhost:~/opt/vmware/share/vami/vami_set_network eth0 STATICV4 192.168.5.98 255.255.255.0 192.168.5.1
/sbin/ifdown: line 233: /dev/.sysconfig/network/config-eth0: Permission denied
IOError: [Errno 13] Permission denied: &lsquo;/opt/vmware/etc/vami/vami_ovf_info.xml&rsquo;
Unable to set the network parameters
[/cc]</p>

<p>So, what if you don´t know the appliance root password?</p>

<p>Most virtual appliances are Linux based, and in this particular case the flavor used was SUSE Enterprise Linux 11.</p>

<p>To reset the root password on a grub based Linux appliance, like SUSE, follow the recipe below:</p>

<p><strong>Note:</strong> As <a href="https://twitter.com/lamw/status/304016471829397504">William Lam pointed out</a> this procedure only works if there no grub password set, if that´s the case download a LiveCD, mount the filesystem and run the password change from there. If the filesystem in the appliance is encrypted, well, then all bets are off.</p>

<ol>
<li><p>In the grub menu select the kernel you want to boot and press tab to shift focus to &ldquo;Boot Options&rdquo;</p></li>

<li><p>Now type _**init =/bin/bash **_and press <em>Enter</em> to continue.<a href="http://vninja.net/wordpress/wp-content/uploads/2013/02/SUSE-PW-RESET-01.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2013/02/SUSE-PW-RESET-01-300x202.png" alt="SUSE-PW-RESET-01" /></a></p></li>

<li><p>You will see a prompt that looks like  <strong>(none):/ #</strong> in the terminal.</p></li>

<li><p>Run the _passwd_ command in terminal to change the password for root.
<a href="none">cc lang=&ldquo;bash&rdquo; width=&ldquo;95%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;</a>:/ # passwd
New Password:
Reenter New Password:
Password changed.
[/cc]</p></li>
</ol>

<p>Reboot the appliance, let it boot up normally, and you should now be able to log on as <strong>root</strong>, with your newly configured password, and run the _vami_set_network _command to configure static IP adressing.</p>

<p>[cc lang=&ldquo;bash&rdquo; width=&ldquo;95%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;]
localhost:~ # /opt/vmware/share/vami/vami_set_network eth0 STATICV4 192.168.5.19 255.255.255.0 192.168.5.1
eth0 device: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)
eth0 device: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)
Network parameters successfully changed to requested values
localhost:~ #
[/cc]</p>

<p>Do yet another reboot, and you should be up and running with a static IP configuration on an appliance deployed without the advanced OVF/OVA properties normally required for that kind of deployment.</p>

<p><strong>Note:</strong> <em>This procedure is more than likely NOT supported by your vendor, and changing the root password might have other consequences for the appliance. If the vendor does not supply the root password i their documentation, there is likely to be a reason for that, but the procedure above shows that not supplying it does not actually prevent anyone from changing it. USE AT OWN RISK.</em></p>

</div>


      
    </div>
    
  </div>
</div>
    
<footer class="footer hidden-print">
  <div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
           <div class="pull-left">
  <a class="toplink" href="javascript:" id="return-to-top">back to top</a>
</div>
<div class="pull-right">

</div>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
              
    
<div class="container footline">
    <small>
</small>
</div>


    
<div class="container copyright">
    <small>
  &copy; Christian Mohn

  </small>
</div>



        </div>
    </div>
  </div>
</footer>

    

<script src="//s3.amazonaws.com/mailmunch/static/site.js" id="mailmunch-script" data-mailmunch-site-id="" async="async"></script>



<script src="//load.sumome.com/" data-sumo-site-id="" async="async"></script>

<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>


<script src="/js/highlight.pack.js"></script>
<script src="/js/site.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>
var ENABLE_POPOVER = "", 
EXPIRE_COOKIE = "", 
SHOW_MODAL_TIMEOUT = "", 
MOUSE_LEAVE = "", 
MODAL_SIZE = "", 
POST_URL = "", 
SIGNUP_HEADER = "",
HEADER_IMAGE = "",
IMG_DESCRIPTION = "",
SIGNUP_TEXT = "",
INPUT_PLACEHOLDER = "",
SUBMIT_BUTTON = "",
SUCCESS_MESSAGE = "",
ERROR_MESSAGE = "",
OPTIN = "",
COOKIE_NAME = "",
CONTENTLANGUAGE = ""; 
</script>





<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax//MathJax.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax//config/TeX-AMS-MML_HTMLorMML.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    for(var all in MathJax.Hub.getAllJax()) {
        all.SourceElement().parentNode.className += ' has-jax';

    }
});
</script>






  </body>
</html>

