<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Applescript, Desktop Wallpaper and Growl. Automagically.  &middot; Adventures in Hugo</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="There is a thin line between agile and fragile" />

<meta name="keywords" content="Applescript, automation, fun, Mac, OS X, Scripting, ">


<meta property="og:title" content="Applescript, Desktop Wallpaper and Growl. Automagically.  &middot; Adventures in Hugo ">
<meta property="og:site_name" content="Adventures in Hugo"/>
<meta property="og:url" content="/osx/applescript-desktop-wallpaper-growl-automatically/" />
<meta property="og:locale" content="en-us">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2012-07-24T23:31:12Z" />
<meta property="og:article:modified_time" content="2012-07-24T23:31:12Z" />

  
    
<meta property="og:article:tag" content="Applescript">
    
<meta property="og:article:tag" content="automation">
    
<meta property="og:article:tag" content="fun">
    
<meta property="og:article:tag" content="Mac">
    
<meta property="og:article:tag" content="OS X">
    
<meta property="og:article:tag" content="Scripting">
    
  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@" />
<meta name="twitter:title" content="Applescript, Desktop Wallpaper and Growl. Automagically." />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="/osx/applescript-desktop-wallpaper-growl-automatically/" />
<meta name="twitter:domain" content="/">
  

  
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "Applescript, Desktop Wallpaper and Growl. Automagically.",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2012-07-24",
    "description": "",
    "wordCount": 749
  }
</script>
  



<link rel="canonical" href="/osx/applescript-desktop-wallpaper-growl-automatically/" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
<link rel="icon" href="/favicon.png">
<meta name="generator" content="Hugo 0.40.3" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->



    <link rel="stylesheet" href="/css/bootswatch/default/bootstrap.min.css">


<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css">




  <link rel="stylesheet" href="/css/highlight/default.css">


</head>
<body data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
    <header id="main-header">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        
          
          <a class="navbar-brand-img" href="/">
            <img alt="" src="">
            
          </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            
            
            
              
          </ul>
        </div>
        
      </div>
    </nav>
  </header>





<div class="container">
  <div class="row">
    <div class="col-sm-12">


      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" >
<header class="container hat">
  <h1>Applescript, Desktop Wallpaper and Growl. Automagically.
</h1>

</header>
</div>


      <div class="content">
  

<p>I´ve been a Mac and OS X user now for about 7 months, but to be honest I have not been very experimental in my usage of my Macbook Air. Until now, my main focus has been basic usage of the hardware and operating systems, and making it work in my corporate environment. As I feel that I´ve reached mission accomplished status on that initial project, I decided to use some of my &ldquo;free&rdquo; vacation time to play around a bit and experiment a bit more.</p>

<p>For some reason, I decided to start to play around a bit with Applescript and try to create something that changes my desktop wallpaper based on a &ldquo;Home&rdquo; and a &ldquo;Work&rdquo; scenario. Initially I made a quick script, my first ever Applescript, that presented a dialog box asking me if &ldquo;Home&rdquo; or &ldquo;Work&rdquo; was the current status, and then changed the desktop wallpaper accordingly. I then assigned that to a hotkey, so I could quickly change between the two modes.</p>

<p>That solution left me with two things; <em>One, it worked!</em> and Two, it could be done better by adding some automation to it.</p>

<p>Here is the solution I ended up with:</p>

<p>[cc lang=&ldquo;applescript&rdquo; tab_size=&ldquo;2&rdquo;]</p>

<h1 id="populate-ipaddr-variable-with-ip-address">Populate ipaddr variable with IP address</h1>

<p>set ipaddr to do shell script &ldquo;ifconfig | awk &lsquo;/broadcast/ {print $2}&rsquo; | tail -1&rdquo;</p>

<h1 id="check-if-connection-is-home-connection-based-on-ip-subnet">Check if connection is home connection, based on IP subnet</h1>

<h1 id="if-not-connected-set-ipaddr-variable-to-0-0-0-0-to-avoid-empty-variable-issues">If not connected, set ipaddr variable to 0.0.0.0 to avoid empty variable issues</h1>

<h1 id="dirty-hack-to-add-padding-to-zero-values-but-hey-it-works-for-me">Dirty hack to add padding to zero values, but hey, it works for me.</h1>

<p>if (ipaddr is &ldquo;&rdquo;) then
set ipaddr to &ldquo;000.000.0.0&rdquo;
end if</p>

<p>set ipaddrtxt to (characters 1 thru 9 of ipaddr) as string
if ipaddrtxt is &ldquo;192.168.5&rdquo; then # Change this to your own subnet
set situation to &ldquo;Home&rdquo;
else
set situation to &ldquo;Work&rdquo;
end if</p>

<h1 id="get-current-desktop-image-path">Get current desktop image path</h1>

<p>tell application &ldquo;System Events&rdquo;
tell current desktop
set currentDesktop to (get picture as text)
end tell
end tell</p>

<h1 id="build-the-desktop-image-path">Build the desktop image path</h1>

<p>set desktopPath to &ldquo;Macintosh HD:Users::Dropbox:switcher:&rdquo; &amp; situation &amp; &ldquo;.png&rdquo; # Change this to your own paths</p>

<h1 id="only-tell-finder-to-change-the-desktop-and-notify-growl-if-a-change-is-required-eg-desktop-path-not-equal-to-current-path">Only tell Finder to change the desktop and notify Growl if a change is required (eg. desktop path not equal to current path)</h1>

<p>if currentDesktop is not desktopPath then</p>

<h1 id="tell-finder-to-change-the-desktop">Tell Finder to change the desktop</h1>

<p>tell application &ldquo;Finder&rdquo;
set desktop picture to {desktopPath} as alias
end tell</p>

<p>tell application &ldquo;GrowlHelperApp&rdquo;
set the allNotificationsList to {&ldquo;Wallpaper Change&rdquo;}
set the enabledNotificationsList to {&ldquo;Wallpaper Change&rdquo;}
register as application &ldquo;Wallpaper Change&rdquo; all notifications allNotificationsList default notifications enabledNotificationsList icon of application &ldquo;Script Editor&rdquo;
&ndash; Send a Notification&hellip;
notify with name &ldquo;Wallpaper Change&rdquo; title &ldquo;Wallpaper Change&rdquo; description &ldquo;Wallpaper changed to &rdquo; &amp; (situation) application name &ldquo;Wallpaper Change&rdquo;
end tell
end if
[/cc]</p>

<p>I know my theme isn´t very suited for code pastes, so the whole applescript source code is also available for <a href="https://dl.dropbox.com/u/20629/vninja/Switcher.scpt">download</a>.</p>

<p>After the script was finished, I added it to my <a href="http://projects.tynsoe.org/en/geektool/">Geektools</a> bash script, that refreshes at a fairly frequent interval:</p>

<p>[cc lang=&ldquo;bash&rdquo; tab_size=&ldquo;2&rdquo;]</p>

<h1 id="run-background-switcher-applescript">Run Background Switcher Applescript</h1>

<p>osascript /Applescript/Switcher.scpt
[/cc]</p>

<p>Sure, I could have used a crontab instead, but for me the easiest way to get this working quickly was to add it to the existing setup I had in place.</p>

<h3 id="demo-time">Demo time!</h3>

<p>The Applescript detects if the computers IP address is on a given subnet, and if so it sets the wallpaper specified for that subnet, dubbed &ldquo;Home&rdquo;. If it determines that it is not on that particular subnet, it´s officially at &ldquo;Work&rdquo; and sets the wallpaper accordingly. That´s all the logic there is too it, and I´m sure that can be improved either by me or more likely someone who has been hit by the Applescript clue bat.</p>

<p>My desktop Wallpaper images are stored in a given folder in my Dropbox, with one of them called <em>Home</em> and the other called <em>Work</em>. This limits the script to those two given file names, and switches between the two accordingly. It also assumes the the files are on the <em>PNG</em> format. An added bonus by storing the files in Dropbox is that I can remotely change out the image, and keep the wallpapers synchronized between several computes if I wish to do so.</p>

<p>Note that I am under no circumstances a developer and that this is my first Applescript. I am sure there are much better ways to accomplish the same things, with better error handling and overall better code quality, but the fact is that this works for me and I´m happy with it.</p>

</div>


      
    </div>
    
  </div>
</div>
    
<footer class="footer hidden-print">
  <div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
           <div class="pull-left">
  <a class="toplink" href="javascript:" id="return-to-top">back to top</a>
</div>
<div class="pull-right">

</div>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
              
    
<div class="container footline">
    <small>
</small>
</div>


    
<div class="container copyright">
    <small>
  &copy; Christian Mohn

  </small>
</div>



        </div>
    </div>
  </div>
</footer>

    

<script src="//s3.amazonaws.com/mailmunch/static/site.js" id="mailmunch-script" data-mailmunch-site-id="" async="async"></script>



<script src="//load.sumome.com/" data-sumo-site-id="" async="async"></script>

<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>


<script src="/js/highlight.pack.js"></script>
<script src="/js/site.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>
var ENABLE_POPOVER = "", 
EXPIRE_COOKIE = "", 
SHOW_MODAL_TIMEOUT = "", 
MOUSE_LEAVE = "", 
MODAL_SIZE = "", 
POST_URL = "", 
SIGNUP_HEADER = "",
HEADER_IMAGE = "",
IMG_DESCRIPTION = "",
SIGNUP_TEXT = "",
INPUT_PLACEHOLDER = "",
SUBMIT_BUTTON = "",
SUCCESS_MESSAGE = "",
ERROR_MESSAGE = "",
OPTIN = "",
COOKIE_NAME = "",
CONTENTLANGUAGE = ""; 
</script>





<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax//MathJax.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax//config/TeX-AMS-MML_HTMLorMML.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    for(var all in MathJax.Hub.getAllJax()) {
        all.SourceElement().parentNode.className += ' has-jax';

    }
});
</script>






  </body>
</html>

