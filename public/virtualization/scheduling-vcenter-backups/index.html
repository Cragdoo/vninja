<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Scheduling vCenter Backups  &middot; Adventures in Hugo</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="There is a thin line between agile and fragile" />

<meta name="keywords" content="Backup, Ops, SQL Server Express, vCenter, VMware, ">


<meta property="og:title" content="Scheduling vCenter Backups  &middot; Adventures in Hugo ">
<meta property="og:site_name" content="Adventures in Hugo"/>
<meta property="og:url" content="/virtualization/scheduling-vcenter-backups/" />
<meta property="og:locale" content="en-us">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2010-07-22T12:17:56Z" />
<meta property="og:article:modified_time" content="2010-07-22T12:17:56Z" />

  
    
<meta property="og:article:tag" content="Backup">
    
<meta property="og:article:tag" content="Ops">
    
<meta property="og:article:tag" content="SQL Server Express">
    
<meta property="og:article:tag" content="vCenter">
    
<meta property="og:article:tag" content="VMware">
    
  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@" />
<meta name="twitter:title" content="Scheduling vCenter Backups" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="/virtualization/scheduling-vcenter-backups/" />
<meta name="twitter:domain" content="/">
  

  
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "Scheduling vCenter Backups",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2010-07-22",
    "description": "",
    "wordCount": 619
  }
</script>
  



<link rel="canonical" href="/virtualization/scheduling-vcenter-backups/" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
<link rel="icon" href="/favicon.png">
<meta name="generator" content="Hugo 0.40.3" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->



    <link rel="stylesheet" href="/css/bootswatch/default/bootstrap.min.css">


<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css">




  <link rel="stylesheet" href="/css/highlight/default.css">


</head>
<body data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
    <header id="main-header">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        
          
          <a class="navbar-brand-img" href="/">
            <img alt="" src="">
            
          </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            
            
            
              
          </ul>
        </div>
        
      </div>
    </nav>
  </header>





<div class="container">
  <div class="row">
    <div class="col-sm-12">


      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" >
<header class="container hat">
  <h1>Scheduling vCenter Backups
</h1>

</header>
</div>


      <div class="content">
  

<p><img src="/images/logos/vmware-logo.gif" alt="" />If you run your vCenter on SQL Server Express 2005, you are missing the ability to set up scheduled backup jobs with SQL Maintenance Plans, a feature available in the full version of SQL Server.</p>

<p>This might not be a problem if your backup software has SQL Server agents that you use to backup your vCenter databaser, but in smaller environments or even in your lab, you might not have that kind of backup scheme available to you, so what do you do? Thankfully there are ways of setting up the same kind of scheduled backups in SQL Server Express, without being a SQL Server Guru.</p>

<h4 id="creating-a-backup-script">Creating a Backup Script</h4>

<p>If you don&rsquo;t have <a href="http://www.microsoft.com/downloads/details.aspx?familyid=c243a5ae-4bd1-4e3d-94b8-5a0f62bf7796&amp;displaylang=en">SQL Server Management Studio Express</a> installed already, download and install it now.</p>

<p>Fire it up and log on with a user that has sufficient permissions to access the vCenter database</p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2010/07/1.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2010/07/1-300x224.png" alt="" /></a></p>

<p>Find your vCenter database by expanding <em>Databases</em> and select <strong>VIM_VCDB</strong></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-2.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-2-300x246.png" alt="" /></a></p>

<p>Right click on <strong>VIM_VCDB</strong> and select <em>Tasks</em> and then <em>Back Up&hellip;</em></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-3.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-3-300x279.png" alt="" /></a></p>

<p>This opens the Back Up Database window, where you set your backup options. Set your options in a manner that fits your environment. You can set options like the backup file location, retention policy etc.</p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-4.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-4-300x236.png" alt="" /></a></p>

<p>So far, this is all fine and dandy. You can create a manual backup this way, without much hassle. How can we turn that into a scheduled job?</p>

<p>The first bit is to turn your backup options into a SQL script that can be scheduled. You do this by finding the <em>Script</em> drop-down menu on the top of the Backup Database window. Select <em>Script Action to New Query Window</em>.</p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-5.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-5-300x236.png" alt="" /></a></p>

<p>This opens the script window, where you can see the script and test it to make sure it works as intended.</p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-6.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-6-300x225.png" alt="" /></a></p>

<p>The next step is to save the generated script, you do so my going to <em>File</em> and select <strong>Save &hellip; As</strong>. I&rsquo;ve created a folder called _c:\scripts_ that I use to store my SQL scripts in, so I&rsquo;ll save the backup script there as <em>FullBackupVCDB.sql</em>.</p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-61.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-61-300x245.png" alt="" /></a></p>

<h4 id="scheduling-the-backup-script">Scheduling the Backup Script</h4>

<p>Now that we have a working backup script, we need to be able to schedule it to run. As we can&rsquo;t do that within the SQL Server Management Studio Express application, we need to find another way of scheduling it. Windows Server 2008 R2 (and other versions) include a scheduling tool, and that&rsquo;s what we&rsquo;ll use to create our schedule.</p>

<p>On my standard vCenter installation, the SQL Server is installed in the default location of _C:\Program Files (x86)\Microsoft SQL Server_. This means that the actual command we need to schedule will be (be sure to replace the server-/instance-name and script name if your values differ from mine):</p>

<p>_&ldquo;C:\Program Files (x86)\Microsoft SQL Server\90\Tools\Binn\SQLCMD.EXE&rdquo; -S [servername]\SQLEXP<em>VIM -i c:\scripts\FullBackupVCDB.sql</em></p>

<p>Go to the Control Panel and select Schedule Tasks. Click <strong>Create Basic Task</strong>, give it a name and set an appropriate schedule.</p>

<p>Select <strong>Start a program</strong> as the action for the task, and when it asks for <strong>Program/Script</strong> enter _&ldquo;C:\Program Files (x86)\Microsoft SQL Server\90\Tools\Binn\SQLCMD.EXE&rdquo; -S [servername]\SQLEXP<em>VIM -i c:\scripts\FullBackupVCDB.sql</em>.</p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-7.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-7-300x212.png" alt="" /></a></p>

<p>Click next and check the box that says <strong>Open the Properties dialog for this task when I click Finish</strong> then click <em>Finish</em>. In the VCDB Backup properties, make sure the <strong>Run whether user is logged on or not</strong> option is selected, to make sure the schedule runs as planned.</p>

<p><strong>Once you have verified that the schedule works as intended, make sure that you include the location for your vCenter database in your regular backup scheme, and you should we a lot safer than you were.</strong></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-8.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2010/07/Scheduling-vCenter-Backups-8-300x112.png" alt="" /></a></p>

<p><strong>That&rsquo;s it!  Scheduled vCenter backups on SQL Server Express 2005.</strong></p>

<p>Thanks to <a href="http://twitter.com/ChrisDearden">Chris Dearden</a> over at  <a href="http://jfvi.co.uk/">J.F.V.I</a> who helped me out with getting my <em>sqlcmd.exe</em> syntax corrected for the scheduled task!</p>

</div>


      
    </div>
    
  </div>
</div>
    
<footer class="footer hidden-print">
  <div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
           <div class="pull-left">
  <a class="toplink" href="javascript:" id="return-to-top">back to top</a>
</div>
<div class="pull-right">

</div>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
              
    
<div class="container footline">
    <small>
</small>
</div>


    
<div class="container copyright">
    <small>
  &copy; Christian Mohn

  </small>
</div>



        </div>
    </div>
  </div>
</footer>

    

<script src="//s3.amazonaws.com/mailmunch/static/site.js" id="mailmunch-script" data-mailmunch-site-id="" async="async"></script>



<script src="//load.sumome.com/" data-sumo-site-id="" async="async"></script>

<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>


<script src="/js/highlight.pack.js"></script>
<script src="/js/site.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>
var ENABLE_POPOVER = "", 
EXPIRE_COOKIE = "", 
SHOW_MODAL_TIMEOUT = "", 
MOUSE_LEAVE = "", 
MODAL_SIZE = "", 
POST_URL = "", 
SIGNUP_HEADER = "",
HEADER_IMAGE = "",
IMG_DESCRIPTION = "",
SIGNUP_TEXT = "",
INPUT_PLACEHOLDER = "",
SUBMIT_BUTTON = "",
SUCCESS_MESSAGE = "",
ERROR_MESSAGE = "",
OPTIN = "",
COOKIE_NAME = "",
CONTENTLANGUAGE = ""; 
</script>





<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax//MathJax.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax//config/TeX-AMS-MML_HTMLorMML.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    for(var all in MathJax.Hub.getAllJax()) {
        all.SourceElement().parentNode.className += ' has-jax';

    }
});
</script>






  </body>
</html>

