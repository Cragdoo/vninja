<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Adding a secondary NIC to the vCenter 5.1 Appliance (VCSA)" />
<meta property="og:description" content="While building my lab environment, I ran into a situation where I wanted to have a completely sealed off networking segment that had no outside access.
This is a trivial task on it`s own, just create a vSwitch with no physical NICs attached to it, and then connect the VMs to it. The VMs will then have interconnectivity, but no outside network access at all.
In this particular case, I was setting up a couple of nested ESXi servers that I wanted to connect to the &ldquo;outside&rdquo; vCenter Appliance (VCSA)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/virtualization/adding-secondary-nic-vcenter-5-1-appliance-vcsa/" />



<meta property="article:published_time" content="2013-04-25T11:10:33&#43;00:00"/>

<meta property="article:modified_time" content="2013-04-25T11:10:33&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Adding a secondary NIC to the vCenter 5.1 Appliance (VCSA)"/>
<meta name="twitter:description" content="While building my lab environment, I ran into a situation where I wanted to have a completely sealed off networking segment that had no outside access.
This is a trivial task on it`s own, just create a vSwitch with no physical NICs attached to it, and then connect the VMs to it. The VMs will then have interconnectivity, but no outside network access at all.
In this particular case, I was setting up a couple of nested ESXi servers that I wanted to connect to the &ldquo;outside&rdquo; vCenter Appliance (VCSA)."/>
<meta name="generator" content="Hugo 0.40.3" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Adding a secondary NIC to the vCenter 5.1 Appliance (VCSA)",
  "url": "/virtualization/adding-secondary-nic-vcenter-5-1-appliance-vcsa/",
  "wordCount": "467",
  "datePublished": "2013-04-25T11:10:33&#43;00:00",
  "dateModified": "2013-04-25T11:10:33&#43;00:00",
  "author": {
    "@type": "Person",
    "name": "cmohn"
  },
  "keywords": "Virtualization, ESXi, Hack, Networking, vCenter, VCSA, vSphere"
}
</script>



    <link rel="canonical" href="/virtualization/adding-secondary-nic-vcenter-5-1-appliance-vcsa/">

    <title>Adding a secondary NIC to the vCenter 5.1 Appliance (VCSA) | Adventures in Hugo</title>

    <!-- combined, minified CSS -->
    <link href="/css/style.css" rel="stylesheet" integrity="sha384-TbfEhJn4HkgPUIZUhhHaAYsycYKHxSuIloCjZOiyCSpbVunRQxg5T5pxKVFwxilF" crossorigin="anonymous">

    

    

    

    

  </head>

  <body>

    
    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="/">Home</a>
          
          <a class="nav-link" href="https://example.org" title="">Link 1</a>
          
        </nav>
      </div>
    </div>
    

    
    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title"><a href="/" rel="home">Adventures in Hugo</a></h1>
        <p class="lead blog-description">There is a thin line between agile and fragile</p>
      </div>
    </header>
    

    
    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="/virtualization/adding-secondary-nic-vcenter-5-1-appliance-vcsa/">Adding a secondary NIC to the vCenter 5.1 Appliance (VCSA)</a></h2>
    <p class="blog-post-meta"><time datetime="2013-04-25T11:10:33Z">Thu Apr 25, 2013</time> by cmohn in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/virtualization" rel="category tag">Virtualization</a>


<i class="fa fa-tag" aria-hidden="true"></i>&nbsp;<a href="/tags/esxi" rel="tag">ESXi</a>, <a href="/tags/hack" rel="tag">Hack</a>, <a href="/tags/networking" rel="tag">Networking</a>, <a href="/tags/vcenter" rel="tag">vCenter</a>, <a href="/tags/vcsa" rel="tag">VCSA</a>, <a href="/tags/virtualization" rel="tag">Virtualization</a>, <a href="/tags/vsphere" rel="tag">vSphere</a>

</p>
  </header>
  

<p>While building my lab environment, I ran into a situation where I wanted to have a completely sealed off networking segment that had no outside access.</p>

<p>This is a trivial task on it`s own, just create a vSwitch with no physical NICs attached to it, and then connect the VMs to it. The VMs will then have interconnectivity, but no outside network access at all.</p>

<p>In this particular case, I was setting up a couple of nested ESXi servers that I wanted to connect to the &ldquo;outside&rdquo; vCenter Appliance (VCSA). This VCSA instance was not connected to the internal-only vSwitch, but rather to the existing vSwitch that as local network access.</p>

<p>Naturally, the solution would be to add a secondary NIC to the VCSA, and connect that to the internal-only vSwitch.</p>

<p><strong>It turns out that adding a secondary NIC to a VCSA instance, isn`t as straight-forward as you might think.</strong> Sure, adding a new NIC is no problem through either the vSphere Client, or the vSphere Web Client, but getting the NIC configured inside of VCSA is another matter.</p>

<p>If you add a secondary NIC, it will turn up in the VCSA management web page, but you will not be able to save the configuration since the required configuration files for <em>eth1</em> is missing.</p>

<p>In order to rectify this, I performed the following steps:</p>

<ol>
<li><p>Connect to the VCSA via SSH (default username and password is root/vmware)</p></li>

<li><p>Copy <em>/etc/sysconfig/networking/devices/ifcfg-eth0 to /etc/sysconfig/networking/devices/ifcfg-eth1</em></p></li>

<li><p>Edit _ifcfg-eth1 _and replace the networking information with your values, here is how mine looks:
[cc lang=&ldquo;bash&rdquo; width=&ldquo;100%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;]
DEVICE=eth1
BOOTPROTO=&lsquo;static&rsquo;
STARTMODE=&lsquo;auto&rsquo;
TYPE=Ethernet
USERCONTROL=&lsquo;no&rsquo;
IPADDR=&lsquo;172.16.1.52&rsquo;
NETMASK=&lsquo;255.255.255.0&rsquo;
BROADCAST=&lsquo;172.16.1.255&rsquo;
[/cc]</p></li>

<li><p>Create a symlink for this file in /etc/sysconfig/network[cc lang=&ldquo;bash&rdquo; width=&ldquo;100%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;]
ln -s /etc/sysconfig/networking/devices/ifcfg-eth1 /etc/sysconfig/network/ifcfg-eth1[/cc]</p></li>

<li><p>Restart the networking service to activate the new setup:[cc lang=&ldquo;bash&rdquo; width=&ldquo;100%&rdquo; theme=&ldquo;blackboard&rdquo; nowrap=&ldquo;0&rdquo;]
service network restart[/cc]Check the VCSA web management interface to verify that the new settings are active</p></li>
</ol>

<p><img src="http://vninja.net/wordpress/wp-content/uploads/2013/04/Client-2013-04-25-10-54-37-300x200.png" alt="Client 2013-04-25 10-54-37" /></p>

<p>By adding a secondary NIC, configuring it and connecting it to the isolated vSwitch I was now able to add my sequestered nested ESXi hosts to my existing VCSA installation.</p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2013/04/Client-2013-04-25-13-07-01.png"><img src="http://vninja.net/wordpress/wp-content/uploads/2013/04/Client-2013-04-25-13-07-01-300x116.png" alt="Client 2013-04-25 13-07-01" /></a></p>

<p>There may be several reasons for a setup like this, perhaps you want your VCSA to be available on a management VLAN but reach ESXi hosts on another VLAN without having routing in place between the segmented networks, or you just want to play around with it like I am in this lab environment.</p>

<p>Disclaimer:</p>

<p><em>Is this supported by VMware? Probably not, but I simply don`t know. Caveat emptor, and all that jazz.</em></p>

<h4 id="update-february-2016">Update February 2016:</h4>

<p>This post is written with VCSA5.x in mind, and is not tested on VCSA 6.x. William Lam has posted <a href="http://www.virtuallyghetto.com/2016/02/caveats-when-multi-homing-the-vcenter-server-appliance-6-x-wmultiple-vnics.html">Caveats when multi-homing the vCenter Server Appliance 6.x w/multiple vNICs</a> with information on what caveats exist if you are looking to do this with the newer v6.x infrastructure.</p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=%2fvirtualization%2fadding-secondary-nic-vcenter-5-1-appliance-vcsa%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=%2fvirtualization%2fadding-secondary-nic-vcenter-5-1-appliance-vcsa%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fvirtualization%2fadding-secondary-nic-vcenter-5-1-appliance-vcsa%2f" title="Share on LinkedIn"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/home?status=%2fvirtualization%2fadding-secondary-nic-vcenter-5-1-appliance-vcsa%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  

  

  
  <section class="sidebar-module">
    <h4>Links</h4>
    <ol class="list-unstyled">
      
      <li><a href="https://example.com">Link 1</a></li>
      
      <li><a href="https://example.org">Link 2</a></li>
      
    </ol>
  </section>
  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->
    

    
    <footer class="blog-footer">
      <p>
      
      &copy; Christian Mohn
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>
    

  </body>

</html>
