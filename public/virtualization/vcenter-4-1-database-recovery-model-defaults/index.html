<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>vCenter 4.1 Database Recovery Model Defaults  &middot; Adventures in Hugo</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="There is a thin line between agile and fragile" />

<meta name="keywords" content="Backup, Maintenance, Ops, SQL Server Express, vCenter, vSphere, ">


<meta property="og:title" content="vCenter 4.1 Database Recovery Model Defaults  &middot; Adventures in Hugo ">
<meta property="og:site_name" content="Adventures in Hugo"/>
<meta property="og:url" content="/virtualization/vcenter-4-1-database-recovery-model-defaults/" />
<meta property="og:locale" content="en-us">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2010-10-04T21:36:23Z" />
<meta property="og:article:modified_time" content="2010-10-04T21:36:23Z" />

  
    
<meta property="og:article:tag" content="Backup">
    
<meta property="og:article:tag" content="Maintenance">
    
<meta property="og:article:tag" content="Ops">
    
<meta property="og:article:tag" content="SQL Server Express">
    
<meta property="og:article:tag" content="vCenter">
    
<meta property="og:article:tag" content="vSphere">
    
  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@" />
<meta name="twitter:title" content="vCenter 4.1 Database Recovery Model Defaults" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="/virtualization/vcenter-4-1-database-recovery-model-defaults/" />
<meta name="twitter:domain" content="/">
  

  
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "vCenter 4.1 Database Recovery Model Defaults",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2010-10-04",
    "description": "",
    "wordCount": 468
  }
</script>
  



<link rel="canonical" href="/virtualization/vcenter-4-1-database-recovery-model-defaults/" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
<link rel="icon" href="/favicon.png">
<meta name="generator" content="Hugo 0.40.3" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->



    <link rel="stylesheet" href="/css/bootswatch/default/bootstrap.min.css">


<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css">




  <link rel="stylesheet" href="/css/highlight/default.css">


</head>
<body data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
    <header id="main-header">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        
          
          <a class="navbar-brand-img" href="/">
            <img alt="" src="">
            
          </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            
            
            
              
          </ul>
        </div>
        
      </div>
    </nav>
  </header>





<div class="container">
  <div class="row">
    <div class="col-sm-12">


      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" >
<header class="container hat">
  <h1>vCenter 4.1 Database Recovery Model Defaults
</h1>

</header>
</div>


      <div class="content">
  <p><img src="/images/logos/vmware-logo.gif" alt="" />Sometimes leaving the defaults in place might just come back and bite you, hard.</p>

<p>That might also be the case with your vCenter 4.1 database, as I experienced back in July.</p>

<p>All of a sudden my vCenter Server stopped working. The symptoms where pretty obvious, my client couldn&rsquo;t connect to the vCenter server. Naturally I connected to the server, and noticed that the VMware VirtualCenter Server services had indeed stopped. No wonder the client couldn&rsquo;t connect to it. I tried starting it, but if would shut itself down again after a few seconds.</p>

<p>The next step, obviously, was to look at the event logs and there it was, in plain English explaining the service desire to stop:</p>

<pre><code>Log Name:      Application
Source:        MSSQL$SQLEXP_VIM
Date:          17.07.2010 02:06:16
Event ID:      9002
Task Category: (2)
Level:         Error
Keywords:      Classic
User:          SYSTEM
Computer:      [removed]
Description:
The transaction log for database 'VIM_VCDB' is full. To find out why space in the log cannot be reused, see the log_reuse_wait_desc column in sys.databases
</code></pre>

<p>Important bit:
<strong>The transaction log for database &lsquo;VIM_VCDB&rsquo; is full. To find out why space in the log cannot be reused, see the log_reuse_wait_desc column in sys.databases</strong></p>

<p>As it turns out, the transaction log for my SQL Server Express based vCenter install database was indeed full. Not only was it full, it had grown to eat just about each and every byte out of the disk space on the server.</p>

<p>I got around this by changing the recovery model back to simple, and performing a new backup via the script I&rsquo;ve mentioned earlier: <a href="http://vninja.net/virtualization/scheduling-vcenter-backups/">Scheduling vCenter Backups</a>. I&rsquo;m not saying this is how you should configure your own vCenter recovery model, you need to chose one that fits your specific backup scheme. Just make sure you understand how the different settings affect your particular environment.</p>

<p>So, where does the defaults come into play?
As VMware explains in <a href="http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1001046&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=115184631&amp;stateId=0%200%20120616083">KB Article 1001046 : SQL Server Recovery Model Affects Transaction Log Disk Space Requirements</a> the install defaults to the <strong>Bulk Recovery</strong> model. This model allows the transaction log to grow, until a backup clears it and lets it start over. If you, like me, used a scripted backup that doesn&rsquo;t do transaction log pruning you might very well be in the same predicament pretty soon.</p>

<p>_So, take my advice, make sure you understand the backup routines you have in place for your vCenter and check those log settings before your vCenter stops unexpectedly. _</p>

<p><strong>Do yourself a favour, check your log files and do it now.</strong></p>

<p>Of course, this is not the only thing that has an effect on your vCenter Database size. The settings for <a href="http://www.vcritical.com/2009/04/vmware-vcenter-server-performance-stats-levels/">vCenter Server Statistics</a> also comes into play, but in my case the issue was the backup scheme I had in place and the default settings for a new vCenter 4.1 install.</p>

</div>


      
    </div>
    
  </div>
</div>
    
<footer class="footer hidden-print">
  <div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
           <div class="pull-left">
  <a class="toplink" href="javascript:" id="return-to-top">back to top</a>
</div>
<div class="pull-right">

</div>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
              
    
<div class="container footline">
    <small>
</small>
</div>


    
<div class="container copyright">
    <small>
  &copy; Christian Mohn

  </small>
</div>



        </div>
    </div>
  </div>
</footer>

    

<script src="//s3.amazonaws.com/mailmunch/static/site.js" id="mailmunch-script" data-mailmunch-site-id="" async="async"></script>



<script src="//load.sumome.com/" data-sumo-site-id="" async="async"></script>

<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>


<script src="/js/highlight.pack.js"></script>
<script src="/js/site.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>
var ENABLE_POPOVER = "", 
EXPIRE_COOKIE = "", 
SHOW_MODAL_TIMEOUT = "", 
MOUSE_LEAVE = "", 
MODAL_SIZE = "", 
POST_URL = "", 
SIGNUP_HEADER = "",
HEADER_IMAGE = "",
IMG_DESCRIPTION = "",
SIGNUP_TEXT = "",
INPUT_PLACEHOLDER = "",
SUBMIT_BUTTON = "",
SUCCESS_MESSAGE = "",
ERROR_MESSAGE = "",
OPTIN = "",
COOKIE_NAME = "",
CONTENTLANGUAGE = ""; 
</script>





<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax//MathJax.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax//config/TeX-AMS-MML_HTMLorMML.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    for(var all in MathJax.Hub.getAllJax()) {
        all.SourceElement().parentNode.className += ' has-jax';

    }
});
</script>






  </body>
</html>

