<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="vCenter 4.1 Database Recovery Model Defaults" />
<meta property="og:description" content="Sometimes leaving the defaults in place might just come back and bite you, hard.
That might also be the case with your vCenter 4.1 database, as I experienced back in July.
All of a sudden my vCenter Server stopped working. The symptoms where pretty obvious, my client couldn&rsquo;t connect to the vCenter server. Naturally I connected to the server, and noticed that the VMware VirtualCenter Server services had indeed stopped. No wonder the client couldn&rsquo;t connect to it." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/virtualization/vcenter-4-1-database-recovery-model-defaults/" />



<meta property="article:published_time" content="2010-10-04T21:36:23&#43;00:00"/>

<meta property="article:modified_time" content="2010-10-04T21:36:23&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="vCenter 4.1 Database Recovery Model Defaults"/>
<meta name="twitter:description" content="Sometimes leaving the defaults in place might just come back and bite you, hard.
That might also be the case with your vCenter 4.1 database, as I experienced back in July.
All of a sudden my vCenter Server stopped working. The symptoms where pretty obvious, my client couldn&rsquo;t connect to the vCenter server. Naturally I connected to the server, and noticed that the VMware VirtualCenter Server services had indeed stopped. No wonder the client couldn&rsquo;t connect to it."/>
<meta name="generator" content="Hugo 0.40.3" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "vCenter 4.1 Database Recovery Model Defaults",
  "url": "/virtualization/vcenter-4-1-database-recovery-model-defaults/",
  "wordCount": "468",
  "datePublished": "2010-10-04T21:36:23&#43;00:00",
  "dateModified": "2010-10-04T21:36:23&#43;00:00",
  "author": {
    "@type": "Person",
    "name": "cmohn"
  },
  "keywords": "Virtualization, Backup, Maintenance, Ops, SQL Server Express, vCenter, vSphere"
}
</script>



    <link rel="canonical" href="/virtualization/vcenter-4-1-database-recovery-model-defaults/">

    <title>vCenter 4.1 Database Recovery Model Defaults | Adventures in Hugo</title>

    <!-- combined, minified CSS -->
    <link href="/css/style.css" rel="stylesheet" integrity="sha384-NnQTHLV1boeEOT&#43;VkddkaZe9ipwgoxh1CLY2U3LM36/GQpTS/1l4lL/5LnWh02Wk" crossorigin="anonymous">

    

    

    

    

  </head>

  <body>

    
    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="/">Home</a>
          
          <a class="nav-link" href="https://example.org" title="">Link 1</a>
          
        </nav>
      </div>
    </div>
    

    
    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title"><a href="/" rel="home">Adventures in Hugo</a></h1>
        <p class="lead blog-description">There is a thin line between agile and fragile</p>
      </div>
    </header>
    

    
    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="/virtualization/vcenter-4-1-database-recovery-model-defaults/">vCenter 4.1 Database Recovery Model Defaults</a></h2>
    <p class="blog-post-meta"><time datetime="2010-10-04T21:36:23Z">Mon Oct 04, 2010</time> by cmohn in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/virtualization" rel="category tag">Virtualization</a>


<i class="fa fa-tag" aria-hidden="true"></i>&nbsp;<a href="/tags/backup" rel="tag">Backup</a>, <a href="/tags/maintenance" rel="tag">Maintenance</a>, <a href="/tags/ops" rel="tag">Ops</a>, <a href="/tags/sql-server-express" rel="tag">SQL Server Express</a>, <a href="/tags/vcenter" rel="tag">vCenter</a>, <a href="/tags/vsphere" rel="tag">vSphere</a>

</p>
  </header>
  <p><img src="/images/logos/vmware-logo.gif" alt="" />Sometimes leaving the defaults in place might just come back and bite you, hard.</p>

<p>That might also be the case with your vCenter 4.1 database, as I experienced back in July.</p>

<p>All of a sudden my vCenter Server stopped working. The symptoms where pretty obvious, my client couldn&rsquo;t connect to the vCenter server. Naturally I connected to the server, and noticed that the VMware VirtualCenter Server services had indeed stopped. No wonder the client couldn&rsquo;t connect to it. I tried starting it, but if would shut itself down again after a few seconds.</p>

<p>The next step, obviously, was to look at the event logs and there it was, in plain English explaining the service desire to stop:</p>

<pre><code>Log Name:      Application
Source:        MSSQL$SQLEXP_VIM
Date:          17.07.2010 02:06:16
Event ID:      9002
Task Category: (2)
Level:         Error
Keywords:      Classic
User:          SYSTEM
Computer:      [removed]
Description:
The transaction log for database 'VIM_VCDB' is full. To find out why space in the log cannot be reused, see the log_reuse_wait_desc column in sys.databases
</code></pre>

<p>Important bit:
<strong>The transaction log for database &lsquo;VIM_VCDB&rsquo; is full. To find out why space in the log cannot be reused, see the log_reuse_wait_desc column in sys.databases</strong></p>

<p>As it turns out, the transaction log for my SQL Server Express based vCenter install database was indeed full. Not only was it full, it had grown to eat just about each and every byte out of the disk space on the server.</p>

<p>I got around this by changing the recovery model back to simple, and performing a new backup via the script I&rsquo;ve mentioned earlier: <a href="http://vninja.net/virtualization/scheduling-vcenter-backups/">Scheduling vCenter Backups</a>. I&rsquo;m not saying this is how you should configure your own vCenter recovery model, you need to chose one that fits your specific backup scheme. Just make sure you understand how the different settings affect your particular environment.</p>

<p>So, where does the defaults come into play?
As VMware explains in <a href="http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1001046&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=115184631&amp;stateId=0%200%20120616083">KB Article 1001046 : SQL Server Recovery Model Affects Transaction Log Disk Space Requirements</a> the install defaults to the <strong>Bulk Recovery</strong> model. This model allows the transaction log to grow, until a backup clears it and lets it start over. If you, like me, used a scripted backup that doesn&rsquo;t do transaction log pruning you might very well be in the same predicament pretty soon.</p>

<p>_So, take my advice, make sure you understand the backup routines you have in place for your vCenter and check those log settings before your vCenter stops unexpectedly. _</p>

<p><strong>Do yourself a favour, check your log files and do it now.</strong></p>

<p>Of course, this is not the only thing that has an effect on your vCenter Database size. The settings for <a href="http://www.vcritical.com/2009/04/vmware-vcenter-server-performance-stats-levels/">vCenter Server Statistics</a> also comes into play, but in my case the issue was the backup scheme I had in place and the default settings for a new vCenter 4.1 install.</p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=%2fvirtualization%2fvcenter-4-1-database-recovery-model-defaults%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=%2fvirtualization%2fvcenter-4-1-database-recovery-model-defaults%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fvirtualization%2fvcenter-4-1-database-recovery-model-defaults%2f" title="Share on LinkedIn"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/home?status=%2fvirtualization%2fvcenter-4-1-database-recovery-model-defaults%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  

  

  
  <section class="sidebar-module">
    <h4>Links</h4>
    <ol class="list-unstyled">
      
      <li><a href="https://example.com">Link 1</a></li>
      
      <li><a href="https://example.org">Link 2</a></li>
      
    </ol>
  </section>
  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->
    

    
    <footer class="blog-footer">
      <p>
      
      &copy; Christian Mohn
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>
    

  </body>

</html>
