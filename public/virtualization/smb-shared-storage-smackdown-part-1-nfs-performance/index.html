<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SMB Shared Storage Smackdown - Part 1 NFS Performance  &middot; My blog</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="">


<meta property="og:title" content="SMB Shared Storage Smackdown - Part 1 NFS Performance  &middot; My blog ">
<meta property="og:site_name" content="My blog"/>
<meta property="og:url" content="/virtualization/smb-shared-storage-smackdown-part-1-nfs-performance/" />
<meta property="og:locale" content="en">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2011-07-17T19:31:22Z" />
<meta property="og:article:modified_time" content="2011-07-17T19:31:22Z" />

  

  

  



<link rel="canonical" href="/virtualization/smb-shared-storage-smackdown-part-1-nfs-performance/" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
<link rel="icon" href="/favicon.png">
<meta name="generator" content="Hugo 0.40.3" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->



    <link rel="stylesheet" href="/css/bootswatch/paper/bootstrap.min.css">


<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css">




  <link rel="stylesheet" href="/css/highlight/default.css">


</head>
<body data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
    <header id="main-header">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        
          
          <a class="navbar-brand-img" href="/">
            <img alt="Appernetic blog" src="http://blog.appernetic.io/images/apperneticlogo.png">
            
          </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            
            
            <li class="">
              
                <a href="https://appernetic.io/app/#/about" >
                  <i class='fa fa-road'></i>
                  About
                </a>
              
            </li>
            
            <li class="">
              
                <a href="/post/" >
                  
                  Blog
                </a>
              
            </li>
            
            <li class="">
              
                <a href="https://appernetic.io/app/" >
                  
                  Dashboard
                </a>
              
            </li>
            
            
              
          </ul>
        </div>
        
      </div>
    </nav>
  </header>





<div class="container">
  <div class="row">
    <div class="col-sm-9">


      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" >
<header class="container hat">
  <h1>SMB Shared Storage Smackdown - Part 1 NFS Performance
</h1>

</header>
</div>


      <div class="content">
  <p>Recently at the office I was given the task to test out some SMB NAS products to use as potential candidates for some of our small branch offices all over the world.  I did many tests relating from backup and replication to actually running VMs on them and pounding them with IOmeter.  What I will share with you in this series of  posts is my vSphere/IOmeter tests for NFS and iSCSI. With these tests my main goal was to see what kinds of IO loads the NAS devices could handle and also how suitable they would be for running a small vSphere environment.  In my next post I will go into iSCSI performance and will publish all of my results including NFS into a downloadable PDF.</p>

<p><strong>NAS Devices</strong></p>

<ul>
<li><p>Synology DS411+</p></li>

<li><p>NetGear ReadyNAS NV+</p></li>

<li><p>QNAP TS4139 Pro II+</p></li>

<li><p>Iomega StorCenter ix4-200d</p></li>
</ul>

<p>I chose all 4 drive models of the arrays and they are all filled with 1 TB SATA disks.  It was chosen this way since we would also be using these devices to hold rather large backups and replicate them elsewhere.</p>

<p>To start out with I upgraded all of them to the latest firmware and created RAID 5 arrays on each of them.  To make a long story short this gave me anywhere from 2.5 TB - 2.8 TB usable storage on each device.  Since I tested both NFS and iSCSI I first created a 1 TB iSCSI Lun (1MB block size on Datastore) on each device then created an NFS export for the remainder of the space.  Another small note is I was sure that write cacheing was enabled for all arrays that had an option to have to have turned on or off.  Then I got down to setting up vSphere and the rest of my hardware.</p>

<p><strong>Server/VM/Network Infrastructure</strong></p>

<ul>
<li><p>1 HP DL380 G5 - 2 quad core pCPUs - 16 logical cores with HT enabled 16GB of pRAM - ESXi 4.1 U1 installed default configuration</p></li>

<li><p>Win2k8 VMs on each NAS Device 24GB boot device VMDK 100GB VMDK with standard LSI logic SAS connector 1 vCPU and 4096 vRAM</p></li>

<li><p>DELL Powerconnect 5524 Switch - Split up into VLAN for VMs/vSphere Management and VLAN for iSCSI/NFS traffic</p></li>
</ul>

<p>I began the task of plugging everything in, getting everything set up properly as not to skew any results, and spinning up VMs in the Datastores from the attached iSCSI Luns/NFS Exports.  It is important to note that for each Shared Storage Datastore I created a new VM in the exact specifications as above via Template and  aligned all disks to 64k. For the connection to the storage I only had 1 extra 1gbe Nic per server.  Then in ESXi I created a seperate standard vSwitch just for iSCSI/NFS traffic.  If you are interested in the setup of my lab infrastructure please <a href="http://www.twitter.com/eczerwin">Contact me</a> and I will be happy to go more indepth.</p>

<p><strong>Testing Method and Results Collection</strong></p>

<p>After playing around with Iometer for some time and searching around to find a standard I decided to use the tests from the very popular VMware communities <a href="http://communities.vmware.com/thread/73745">Open unofficial storage performance thread</a>.  The exact ICF file I used can also be found there for download if you would like to do some of your own tests.  Regardless of the age of some of the posts I still think this is the most relevent and fair measure possible.  These tests include</p>

<ul>
<li><p>Max Throughput-100% Read</p></li>

<li><p>RealLife-60% random - 65% Read</p></li>

<li><p>Max Throughput-50% Read</p></li>

<li><p>Random-8k 70% Read</p></li>
</ul>

<p>First important thing to mention is only the VM generating the load was powered on during each test so there should be no skewing based on this. I put the IOmeter files into a set of Excel bar graphs.  I decided to base my results on what I call the big 3; Total IOps, MBps, and Average latency.</p>

<p><strong>NFS Final Performance Results</strong></p>

<p><em><strong>NFS Max Throughput 100% Read</strong></em></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS100ReadIOps.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS100ReadIOps.jpg" alt="" /></a></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS100ReadMBps.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS100ReadMBps.jpg" alt="" /></a></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS100ReadART.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS100ReadART.jpg" alt="" /></a></p>

<p><em><strong> RealLife-60% random - 65% Read</strong></em></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS60RandomIOps1.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS60RandomIOps1.jpg" alt="" /></a>
<a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS60RandMBps.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS60RandMBps.jpg" alt="" /></a></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS60RandART.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS60RandART.jpg" alt="" /></a></p>

<p><em><strong>Max Throughput-50% Read</strong></em></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS50ReadIOps.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS50ReadIOps.jpg" alt="" /></a></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS50ReadMBps.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS50ReadMBps.jpg" alt="" /></a></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS50ReadART.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS50ReadART.jpg" alt="" /></a></p>

<p><em><strong>Random-8k 70% Read</strong></em></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS70RandIOps.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS70RandIOps.jpg" alt="" /></a></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS70RandMBps.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS70RandMBps.jpg" alt="" /></a></p>

<p><a href="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS70RandART.jpg"><img src="http://vninja.net/wordpress/wp-content/uploads/2011/07/NFS70RandART.jpg" alt="" /></a></p>

<p><strong>Final Conclusions For NFS and closing</strong></p>

<p>As you may have noticed by the assorted graphs the two winners to come out in the NFS performance tests were QNAP and Synology.  QNAP appears to be slightly better at more Random workloads such as a real life vSphere environment and Synology seems to be way ahead of most of the arrays with solid sequential storage access - which would be perfect for a backup device.  However, they all seem to have high Average Response Times during Random workloads which in my opinon makes or breaks how well an environment runs.  From this first look I would say most of these NAS devices would be just fine for shared storage in a very small lab environment, a possible backup target, or for something simple as a fileserver volume.  In my next post we can put it all together with the iSCSI results and declare the final winner of the <strong>SMB Shared Storage Smackdown</strong>!!!</p>

</div>


      
    </div>
    
      <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
        <div>
  

    <div class="section">
      <header><div class="title"><b>Latest Posts</b></div></header>
      <div class="content">
        <ul>
        
        </ul>
      </div>
    </div>

    
      
      
      <div class="section taxonomies">
        <header><div class="title"><b>tag</b></div></header>

        <div class="content">
          <ul>
            <li><a href="/tags/vmware">vmware</a></li><li><a href="/tags/vsphere">vsphere</a></li><li><a href="/tags/vcenter">vcenter</a></li><li><a href="/tags/fun">fun</a></li><li><a href="/tags/ops">ops</a></li><li><a href="/tags/virtualization">virtualization</a></li><li><a href="/tags/esxi">esxi</a></li><li><a href="/tags/vmworld">vmworld</a></li><li><a href="/tags/news">news</a></li><li><a href="/tags/veeam">veeam</a></li>
          </ul>
        </div>
      </div>
      
    
      
      
    

</div>

      </div>
    
  </div>
</div>
    
<footer class="footer hidden-print">
  <div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
           <div class="pull-left">
  <a class="toplink" href="javascript:" id="return-to-top">back to top</a>
</div>
<div class="pull-right">

<a href="/disclaimer/">Disclaimer</a> <i>&middot;</i>

<a href="/terms/">Terms</a> 

</div>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
              
    
<div class="container footline">
    <small>
  code with <i class='fa fa-heart'></i>

</small>
</div>


    
<div class="container copyright">
    <small>
  &copy; 2016 Copyright my blog

  </small>
</div>



        </div>
    </div>
  </div>
</footer>

    

<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>


<script src="/js/highlight.pack.js"></script>
<script src="/js/site.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>
  var _gaq=[['_setAccount','Your Google Analytics tracking code'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

<script>
var ENABLE_POPOVER =  false , 
EXPIRE_COOKIE =  5 , 
SHOW_MODAL_TIMEOUT =  10000 , 
MOUSE_LEAVE =  true , 
MODAL_SIZE = "", 
POST_URL = "https://zapier.com/hooks/...", 
SIGNUP_HEADER = "Join Our Newsletter",
HEADER_IMAGE = "//placehold.it/1000x600",
IMG_DESCRIPTION = "Placeholder image for this popover modal optin form",
SIGNUP_TEXT = "Signup today for free and be the first to get notified on new updates.",
INPUT_PLACEHOLDER = "Enter your email",
SUBMIT_BUTTON = "Subscribe",
SUCCESS_MESSAGE = "Thanks for your subscription!",
ERROR_MESSAGE = "Submitting form failed!",
OPTIN =  true ,
COOKIE_NAME = "mycookie1",
CONTENTLANGUAGE = ""; 
</script>





<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax//MathJax.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax//config/TeX-AMS-MML_HTMLorMML.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    for(var all in MathJax.Hub.getAllJax()) {
        all.SourceElement().parentNode.className += ' has-jax';

    }
});
</script>






  </body>
</html>

