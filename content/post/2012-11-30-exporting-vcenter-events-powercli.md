---
author: Christian Mohn
comments: true
date: 2012-11-30 09:12:50+00:00
layout: post
slug: exporting-vcenter-events-powercli
title: Exporting vCenter Events with PowerCLI
url: /virtualization/exporting-vcenter-events-powercli/
wordpress_id: 2228
categories:
- Virtualization
tags:
- automation
- ESXi
- Oneliner
- PowerCLI
- Powershell
- realworld
- vCenter
- Virtualization
- vSphere
- vSphere 5
- vSphere Client
---

One of my clients has recently been having issues with their storage solution, and wanted to export the events from vCenter that show storage performance degradation, to aid in troubleshooting with the vendor.

_For some reason, and I have yet to confirm that this is a bug with the vCenter 5.0 appliance or the vCenter Desktop Client, when an event export is done, the storage related events are not exported with the rest of the events._

Thankfully we were able to get the event details exported using the following PowerCLI oneliner:

[cc lang="powershell" width="95%" theme="blackboard" nowrap="0"]
PowerCLI C:\log> Get-VIEvent -Start 19/11/2012 -Finish 30/11/2012 | Export-Csv "events.csv" -NoTypeInformation -UseCulture
[/cc]

This generates an _events.csv_ file in the current directory, containing all the events in the given timeframe, from the vCenter it is connected to. And yes, the storage related events missing from the vCenter Desktop Client export are indeed included in the file generated by the [Get-VIEvent](http://www.vmware.com/support/developer/PowerCLI/PowerCLI51/html/Get-VIEvent.html) cmdlet.

**Once again, PowerCLI to the rescue!**
